{"ast":null,"code":"\"use strict\";\n\nvar _slicedToArray = require(\"/Users/yaozixuan/Document/OOSE/my-app/node_modules/@babel/runtime/helpers/slicedToArray\");\n\nvar _toConsumableArray = require(\"/Users/yaozixuan/Document/OOSE/my-app/node_modules/@babel/runtime/helpers/toConsumableArray\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _colorString = _interopRequireDefault(require(\"color-string\"));\n\nvar _plugin = _interopRequireDefault(require(\"../../plugin\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar escape = function escape(target) {\n  return target.replace(/[\\\\;:()]/g, function (matched) {\n    return \"\\\\\".concat(matched[0].codePointAt(0).toString(16), \" \");\n  });\n};\n\nvar optionMatchers = new Map(); // The scale percentage for resize background\n\noptionMatchers.set(/^(\\d*\\.)?\\d+%$/, function (matches) {\n  return {\n    size: matches[0]\n  };\n}); // width and height\n\nvar normalizeLength = function normalizeLength(v) {\n  return \"\".concat(v).concat(/^(\\d*\\.)?\\d+$/.test(v) ? 'px' : '');\n};\n\noptionMatchers.set(/^w(?:idth)?:((?:\\d*\\.)?\\d+(?:%|ch|cm|em|ex|in|mm|pc|pt|px)?|auto)$/, function (matches) {\n  return {\n    width: normalizeLength(matches[1])\n  };\n});\noptionMatchers.set(/^h(?:eight)?:((?:\\d*\\.)?\\d+(?:%|ch|cm|em|ex|in|mm|pc|pt|px)?|auto)$/, function (matches) {\n  return {\n    height: normalizeLength(matches[1])\n  };\n}); // CSS filters\n\noptionMatchers.set(/^blur(?::(.+))?$/, function (matches, meta) {\n  return {\n    filters: [].concat(_toConsumableArray(meta.filters), [['blur', escape(matches[1] || '10px')]])\n  };\n});\noptionMatchers.set(/^brightness(?::(.+))?$/, function (matches, meta) {\n  return {\n    filters: [].concat(_toConsumableArray(meta.filters), [['brightness', escape(matches[1] || '1.5')]])\n  };\n});\noptionMatchers.set(/^contrast(?::(.+))?$/, function (matches, meta) {\n  return {\n    filters: [].concat(_toConsumableArray(meta.filters), [['contrast', escape(matches[1] || '2')]])\n  };\n});\noptionMatchers.set(/^drop-shadow(?::(.+?),(.+?)(?:,(.+?))?(?:,(.+?))?)?$/, function (matches, meta) {\n  var args = [];\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = matches.slice(1)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var arg = _step.value;\n\n      if (arg) {\n        var colorFunc = arg.match(/^(rgba?|hsla?)\\((.*)\\)$/);\n        args.push(colorFunc ? \"\".concat(colorFunc[1], \"(\").concat(escape(colorFunc[2]), \")\") : escape(arg));\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return != null) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return {\n    filters: [].concat(_toConsumableArray(meta.filters), [['drop-shadow', args.join(' ') || '0 5px 10px rgba(0,0,0,.4)']])\n  };\n});\noptionMatchers.set(/^grayscale(?::(.+))?$/, function (matches, meta) {\n  return {\n    filters: [].concat(_toConsumableArray(meta.filters), [['grayscale', escape(matches[1] || '1')]])\n  };\n});\noptionMatchers.set(/^hue-rotate(?::(.+))?$/, function (matches, meta) {\n  return {\n    filters: [].concat(_toConsumableArray(meta.filters), [['hue-rotate', escape(matches[1] || '180deg')]])\n  };\n});\noptionMatchers.set(/^invert(?::(.+))?$/, function (matches, meta) {\n  return {\n    filters: [].concat(_toConsumableArray(meta.filters), [['invert', escape(matches[1] || '1')]])\n  };\n});\noptionMatchers.set(/^opacity(?::(.+))?$/, function (matches, meta) {\n  return {\n    filters: [].concat(_toConsumableArray(meta.filters), [['opacity', escape(matches[1] || '.5')]])\n  };\n});\noptionMatchers.set(/^saturate(?::(.+))?$/, function (matches, meta) {\n  return {\n    filters: [].concat(_toConsumableArray(meta.filters), [['saturate', escape(matches[1] || '2')]])\n  };\n});\noptionMatchers.set(/^sepia(?::(.+))?$/, function (matches, meta) {\n  return {\n    filters: [].concat(_toConsumableArray(meta.filters), [['sepia', escape(matches[1] || '1')]])\n  };\n});\n/**\n * Marpit image parse plugin.\n *\n * Parse image tokens and store the result into `marpitImage` meta. It has an\n * image url and options. The alternative text is regarded as space-separated\n * options.\n *\n * @alias module:markdown/image/parse\n * @param {MarkdownIt} md markdown-it instance.\n */\n\nfunction parseImage(md) {\n  var process = md.core.process; // Store original URL, for the color shorthand.\n  // (Avoid a side effect from link normalization)\n\n  var originalURLMap;\n  var refCount = 0;\n\n  var finalizeTokenAttr = function finalizeTokenAttr(token) {\n    // Convert imprimitive attribute value into primitive string\n    if (token.attrs && Array.isArray(token.attrs)) token.attrs = token.attrs.map(function (_ref) {\n      var _ref2 = _slicedToArray(_ref, 2),\n          name = _ref2[0],\n          value = _ref2[1];\n\n      return [name, value.toString()];\n    });\n\n    if (token.type === 'inline') {\n      // Apply finalization recursively to inline tokens\n      var _iteratorNormalCompletion2 = true;\n      var _didIteratorError2 = false;\n      var _iteratorError2 = undefined;\n\n      try {\n        for (var _iterator2 = token.children[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n          var t = _step2.value;\n          finalizeTokenAttr(t);\n        }\n      } catch (err) {\n        _didIteratorError2 = true;\n        _iteratorError2 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n            _iterator2.return();\n          }\n        } finally {\n          if (_didIteratorError2) {\n            throw _iteratorError2;\n          }\n        }\n      }\n    }\n  };\n\n  md.core.process = function (state) {\n    var normalizeLink = md.normalizeLink; // Prevent reset of WeakMap caused by calling core process internally\n\n    if (refCount === 0) originalURLMap = new WeakMap();\n\n    try {\n      md.normalizeLink = function (url) {\n        // eslint-disable-next-line no-new-wrappers\n        var imprimitiveUrl = new String(normalizeLink.call(md, url));\n        originalURLMap.set(imprimitiveUrl, url);\n        return imprimitiveUrl;\n      };\n\n      refCount += 1;\n      return process.call(md.core, state);\n    } finally {\n      refCount -= 1;\n      md.normalizeLink = normalizeLink;\n\n      if (refCount === 0) {\n        // Apply finalization for every tokens\n        var _iteratorNormalCompletion3 = true;\n        var _didIteratorError3 = false;\n        var _iteratorError3 = undefined;\n\n        try {\n          for (var _iterator3 = state.tokens[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n            var token = _step3.value;\n            finalizeTokenAttr(token);\n          }\n        } catch (err) {\n          _didIteratorError3 = true;\n          _iteratorError3 = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n              _iterator3.return();\n            }\n          } finally {\n            if (_didIteratorError3) {\n              throw _iteratorError3;\n            }\n          }\n        }\n      }\n    }\n  };\n\n  md.inline.ruler2.push('marpit_parse_image', function (_ref3) {\n    var tokens = _ref3.tokens;\n    var _iteratorNormalCompletion4 = true;\n    var _didIteratorError4 = false;\n    var _iteratorError4 = undefined;\n\n    try {\n      for (var _iterator4 = tokens[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n        var token = _step4.value;\n\n        if (token.type === 'image') {\n          var options = token.content.split(/\\s+/).filter(function (s) {\n            return s.length > 0;\n          });\n          var url = token.attrGet('src');\n          var originalUrl = originalURLMap.has(url) ? originalURLMap.get(url) : url;\n          token.meta = token.meta || {};\n          token.meta.marpitImage = _objectSpread({}, token.meta.marpitImage || {}, {\n            url: url.toString(),\n            options: options\n          }); // Detect shorthand for setting color (Use value before normalization)\n\n          if (!!_colorString.default.get(originalUrl) || originalUrl.toLowerCase() === 'currentcolor') {\n            token.meta.marpitImage.color = originalUrl;\n            token.hidden = true;\n          } // Parse keyword through matchers\n\n\n          var _iteratorNormalCompletion5 = true;\n          var _didIteratorError5 = false;\n          var _iteratorError5 = undefined;\n\n          try {\n            for (var _iterator5 = options[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n              var opt = _step5.value;\n              var _iteratorNormalCompletion6 = true;\n              var _didIteratorError6 = false;\n              var _iteratorError6 = undefined;\n\n              try {\n                for (var _iterator6 = optionMatchers[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {\n                  var _step6$value = _slicedToArray(_step6.value, 2),\n                      regexp = _step6$value[0],\n                      mergeFunc = _step6$value[1];\n\n                  var matched = opt.match(regexp);\n                  if (matched) token.meta.marpitImage = _objectSpread({}, token.meta.marpitImage, {}, mergeFunc(matched, _objectSpread({\n                    filters: []\n                  }, token.meta.marpitImage)));\n                }\n              } catch (err) {\n                _didIteratorError6 = true;\n                _iteratorError6 = err;\n              } finally {\n                try {\n                  if (!_iteratorNormalCompletion6 && _iterator6.return != null) {\n                    _iterator6.return();\n                  }\n                } finally {\n                  if (_didIteratorError6) {\n                    throw _iteratorError6;\n                  }\n                }\n              }\n            }\n          } catch (err) {\n            _didIteratorError5 = true;\n            _iteratorError5 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion5 && _iterator5.return != null) {\n                _iterator5.return();\n              }\n            } finally {\n              if (_didIteratorError5) {\n                throw _iteratorError5;\n              }\n            }\n          }\n        }\n      }\n    } catch (err) {\n      _didIteratorError4 = true;\n      _iteratorError4 = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion4 && _iterator4.return != null) {\n          _iterator4.return();\n        }\n      } finally {\n        if (_didIteratorError4) {\n          throw _iteratorError4;\n        }\n      }\n    }\n  });\n}\n\nvar _default = (0, _plugin.default)(parseImage);\n\nexports.default = _default;","map":{"version":3,"sources":["/Users/yaozixuan/Document/OOSE/my-app/node_modules/@marp-team/marpit/lib/markdown/image/parse.js"],"names":["Object","defineProperty","exports","value","default","_colorString","_interopRequireDefault","require","_plugin","obj","__esModule","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","configurable","writable","escape","replace","matched","codePointAt","toString","optionMatchers","Map","set","matches","size","normalizeLength","v","test","width","height","meta","filters","args","slice","arg","colorFunc","match","join","parseImage","md","process","core","originalURLMap","refCount","finalizeTokenAttr","token","attrs","Array","isArray","map","name","type","children","t","state","normalizeLink","WeakMap","url","imprimitiveUrl","String","call","tokens","inline","ruler2","options","content","split","s","attrGet","originalUrl","has","get","marpitImage","toLowerCase","color","hidden","opt","regexp","mergeFunc","_default"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _colorString = _interopRequireDefault(require(\"color-string\"));\n\nvar _plugin = _interopRequireDefault(require(\"../../plugin\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nconst escape = target => target.replace(/[\\\\;:()]/g, matched => `\\\\${matched[0].codePointAt(0).toString(16)} `);\n\nconst optionMatchers = new Map(); // The scale percentage for resize background\n\noptionMatchers.set(/^(\\d*\\.)?\\d+%$/, matches => ({\n  size: matches[0]\n})); // width and height\n\nconst normalizeLength = v => `${v}${/^(\\d*\\.)?\\d+$/.test(v) ? 'px' : ''}`;\n\noptionMatchers.set(/^w(?:idth)?:((?:\\d*\\.)?\\d+(?:%|ch|cm|em|ex|in|mm|pc|pt|px)?|auto)$/, matches => ({\n  width: normalizeLength(matches[1])\n}));\noptionMatchers.set(/^h(?:eight)?:((?:\\d*\\.)?\\d+(?:%|ch|cm|em|ex|in|mm|pc|pt|px)?|auto)$/, matches => ({\n  height: normalizeLength(matches[1])\n})); // CSS filters\n\noptionMatchers.set(/^blur(?::(.+))?$/, (matches, meta) => ({\n  filters: [...meta.filters, ['blur', escape(matches[1] || '10px')]]\n}));\noptionMatchers.set(/^brightness(?::(.+))?$/, (matches, meta) => ({\n  filters: [...meta.filters, ['brightness', escape(matches[1] || '1.5')]]\n}));\noptionMatchers.set(/^contrast(?::(.+))?$/, (matches, meta) => ({\n  filters: [...meta.filters, ['contrast', escape(matches[1] || '2')]]\n}));\noptionMatchers.set(/^drop-shadow(?::(.+?),(.+?)(?:,(.+?))?(?:,(.+?))?)?$/, (matches, meta) => {\n  const args = [];\n\n  for (const arg of matches.slice(1)) {\n    if (arg) {\n      const colorFunc = arg.match(/^(rgba?|hsla?)\\((.*)\\)$/);\n      args.push(colorFunc ? `${colorFunc[1]}(${escape(colorFunc[2])})` : escape(arg));\n    }\n  }\n\n  return {\n    filters: [...meta.filters, ['drop-shadow', args.join(' ') || '0 5px 10px rgba(0,0,0,.4)']]\n  };\n});\noptionMatchers.set(/^grayscale(?::(.+))?$/, (matches, meta) => ({\n  filters: [...meta.filters, ['grayscale', escape(matches[1] || '1')]]\n}));\noptionMatchers.set(/^hue-rotate(?::(.+))?$/, (matches, meta) => ({\n  filters: [...meta.filters, ['hue-rotate', escape(matches[1] || '180deg')]]\n}));\noptionMatchers.set(/^invert(?::(.+))?$/, (matches, meta) => ({\n  filters: [...meta.filters, ['invert', escape(matches[1] || '1')]]\n}));\noptionMatchers.set(/^opacity(?::(.+))?$/, (matches, meta) => ({\n  filters: [...meta.filters, ['opacity', escape(matches[1] || '.5')]]\n}));\noptionMatchers.set(/^saturate(?::(.+))?$/, (matches, meta) => ({\n  filters: [...meta.filters, ['saturate', escape(matches[1] || '2')]]\n}));\noptionMatchers.set(/^sepia(?::(.+))?$/, (matches, meta) => ({\n  filters: [...meta.filters, ['sepia', escape(matches[1] || '1')]]\n}));\n/**\n * Marpit image parse plugin.\n *\n * Parse image tokens and store the result into `marpitImage` meta. It has an\n * image url and options. The alternative text is regarded as space-separated\n * options.\n *\n * @alias module:markdown/image/parse\n * @param {MarkdownIt} md markdown-it instance.\n */\n\nfunction parseImage(md) {\n  const {\n    process\n  } = md.core; // Store original URL, for the color shorthand.\n  // (Avoid a side effect from link normalization)\n\n  let originalURLMap;\n  let refCount = 0;\n\n  const finalizeTokenAttr = token => {\n    // Convert imprimitive attribute value into primitive string\n    if (token.attrs && Array.isArray(token.attrs)) token.attrs = token.attrs.map(([name, value]) => [name, value.toString()]);\n\n    if (token.type === 'inline') {\n      // Apply finalization recursively to inline tokens\n      for (const t of token.children) finalizeTokenAttr(t);\n    }\n  };\n\n  md.core.process = state => {\n    const {\n      normalizeLink\n    } = md; // Prevent reset of WeakMap caused by calling core process internally\n\n    if (refCount === 0) originalURLMap = new WeakMap();\n\n    try {\n      md.normalizeLink = url => {\n        // eslint-disable-next-line no-new-wrappers\n        const imprimitiveUrl = new String(normalizeLink.call(md, url));\n        originalURLMap.set(imprimitiveUrl, url);\n        return imprimitiveUrl;\n      };\n\n      refCount += 1;\n      return process.call(md.core, state);\n    } finally {\n      refCount -= 1;\n      md.normalizeLink = normalizeLink;\n\n      if (refCount === 0) {\n        // Apply finalization for every tokens\n        for (const token of state.tokens) finalizeTokenAttr(token);\n      }\n    }\n  };\n\n  md.inline.ruler2.push('marpit_parse_image', ({\n    tokens\n  }) => {\n    for (const token of tokens) {\n      if (token.type === 'image') {\n        const options = token.content.split(/\\s+/).filter(s => s.length > 0);\n        const url = token.attrGet('src');\n        const originalUrl = originalURLMap.has(url) ? originalURLMap.get(url) : url;\n        token.meta = token.meta || {};\n        token.meta.marpitImage = _objectSpread({}, token.meta.marpitImage || {}, {\n          url: url.toString(),\n          options\n        }); // Detect shorthand for setting color (Use value before normalization)\n\n        if (!!_colorString.default.get(originalUrl) || originalUrl.toLowerCase() === 'currentcolor') {\n          token.meta.marpitImage.color = originalUrl;\n          token.hidden = true;\n        } // Parse keyword through matchers\n\n\n        for (const opt of options) {\n          for (const [regexp, mergeFunc] of optionMatchers) {\n            const matched = opt.match(regexp);\n            if (matched) token.meta.marpitImage = _objectSpread({}, token.meta.marpitImage, {}, mergeFunc(matched, _objectSpread({\n              filters: []\n            }, token.meta.marpitImage)));\n          }\n        }\n      }\n    }\n  });\n}\n\nvar _default = (0, _plugin.default)(parseImage);\n\nexports.default = _default;"]},"metadata":{},"sourceType":"script"}